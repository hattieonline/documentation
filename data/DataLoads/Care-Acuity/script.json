[
    {
        "App":  "Care-Acuity",
        "Section":  "Diagnosis",
        "LoadScriptContent":  [
                                  "///$tab Diagnosis",
                                  "factResidentDiagnosis:",
                                  "LOAD",
                                  "",
                                  "    %CustomerIDKey,",
                                  "    %DateKey as DiagnosisDT,",
                                  "    DiagnosisType,",
                                  "    Diagnosis",
                                  "FROM [lib://DataShare/QVD Transform/QVD_Transform_factResidentDiagnosis.qvd]",
                                  "(qvd);"
                              ]
    },
    {
        "App":  "Care-Acuity",
        "Section":  "dim_ date",
        "LoadScriptContent":  [
                                  "///$tab dim_ date",
                                  "//\tload only the date field from our fact table. name it to a new field",
                                  "temp:",
                                  "load [%DateKey] as RangeDate\t//\tsource field should be the m/d/yyyy field from your fact table.",
                                  "resident  [mstrRentRoll];",
                                  "",
                                  "//\tMinMaxDate finds the lowest and highest dates from the dates.",
                                  "//\tThis has been proven to work much faster than a typical group by on your transaction table.",
                                  "MinMaxDate:  ",
                                  "load min(RangeDate) as MinDate,  ",
                                  "\tmax(RangeDate) as MaxDate;  ",
                                  "load fieldvalue(\u0027RangeDate\u0027,iterno()) as RangeDate ",
                                  "autogenerate(1) while not isnull(fieldvalue(\u0027RangeDate\u0027,iterno()));  ",
                                  " ",
                                  "drop table temp;\t//\tno need to retain",
                                  "",
                                  "let varMinDate=date(peek(\u0027MinDate\u0027,0,\u0027MinMaxDate\u0027));",
                                  "let varMaxDate=date(peek(\u0027MaxDate\u0027,0,\u0027MinMaxDate\u0027));",
                                  "",
                                  "drop table MinMaxDate;\t//\tno need to retain",
                                  "",
                                  "dim_date:",
                                  "LOAD\tMonthYear, ",
                                  "\t\tWeekStart(%DateKey) as WeekStart, ",
                                  "        QuarterStart(%DateKey) as QuarterStart,",
                                  "        %DateKey,",
                                  "        DayName,",
                                  "        IF(%DateKey = Today(), 1, 0) as TodayFlg,",
                                  "    //    if(%DateKey - 90 \u003e= Today(), 1, 0) as T90Flg,",
                                  "        if(WeekStart(%DateKey) = WeekStart(Today()), 1, 0) as CurrentWeekFlg",
                                  "",
                                  "FROM [lib://DataShare/QVD Extract\\QVD_Extract_dimDate.qvd]",
                                  "(qvd)where EffectiveDT \u003e=\u0027$(varMinDate)\u0027 and EffectiveDT \u003c=\u0027$(varMaxDate)\u0027;",
                                  "",
                                  "exit script;"
                              ]
    },
    {
        "App":  "Care-Acuity",
        "Section":  "fact_STL",
        "LoadScriptContent":  [
                                  "///$tab fact_STL",
                                  "fact_stl:",
                                  "LOAD",
                                  "    ShortTermLeaveID,",
                                  "    %CommunityKey,",
                                  "    %CustomerIDKey,",
                                  "    DepartureDT,",
                                  "    ExpectedReturnDT,",
                                  "    OutboundLocation,",
                                  "    1 as STLFlg",
                                  "FROM [lib://DataShare/QVD Transform/QVD_Transform_mstrSTL.qvd]",
                                  "(qvd);"
                              ]
    },
    {
        "App":  "Care-Acuity",
        "Section":  "Main",
        "LoadScriptContent":  [
                                  "///$tab Main",
                                  "SET ThousandSep=\u0027,\u0027;",
                                  "SET DecimalSep=\u0027.\u0027;",
                                  "SET MoneyThousandSep=\u0027,\u0027;",
                                  "SET MoneyDecimalSep=\u0027.\u0027;",
                                  "SET MoneyFormat=\u0027$#,##0.00;-$#,##0.00\u0027;",
                                  "SET TimeFormat=\u0027h:mm:ss TT\u0027;",
                                  "SET DateFormat=\u0027M/D/YYYY\u0027;",
                                  "SET TimestampFormat=\u0027M/D/YYYY h:mm TT\u0027;",
                                  "SET FirstWeekDay=6;",
                                  "SET BrokenWeeks=1;",
                                  "SET ReferenceDay=0;",
                                  "SET FirstMonthOfYear=1;",
                                  "SET CollationLocale=\u0027en-US\u0027;",
                                  "SET MonthNames=\u0027Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec\u0027;",
                                  "SET LongMonthNames=\u0027January;February;March;April;May;June;July;August;September;October;November;December\u0027;",
                                  "SET DayNames=\u0027Mon;Tue;Wed;Thu;Fri;Sat;Sun\u0027;",
                                  "SET LongDayNames=\u0027Monday;Tuesday;Wednesday;Thursday;Friday;Saturday;Sunday\u0027;",
                                  "SET NumericalAbbreviation=\u00273:k;6:M;9:G;12:T;15:P;18:E;21:Z;24:Y;-3:m;-6:??;-9:n;-12:p;-15:f;-18:a;-21:z;-24:y\u0027;",
                                  "SET DISABLE_INSIGHTS = 1;"
                              ]
    },
    {
        "App":  "Care-Acuity",
        "Section":  "Mobility",
        "LoadScriptContent":  [
                                  "///$tab Mobility",
                                  "factResidentMobilityDevice:",
                                  "LOAD",
                                  "    %CustomerIDKey,",
                                  "    MobilityDevice",
                                  "FROM [lib://DataShare/QVD Transform/QVD_Transform_factResidentMobilityDevice.qvd]",
                                  "(qvd);"
                              ]
    },
    {
        "App":  "Care-Acuity",
        "Section":  "Moves",
        "LoadScriptContent":  [
                                  "///$tab Moves",
                                  "tblMoveOuts:",
                                  "LOAD",
                                  "    %CustomerIDKey,",
                                  "    ScheduledMoveOutNoticeDT,",
                                  "    %DateKey as MoveOutDT,",
                                  "    1 as MoveOutFlg",
                                  "FROM [lib://DataShare/QVD Transform/QVD_Transform_factResidentMoveOutSchedule.qvd] (qvd)",
                                  "WHERE Exists([%CustomerIDKey]) and %DateKey \u003e Today() and %DateKey \u003c= Today() + 14;",
                                  "",
                                  "//fact_moveins:",
                                  "OUTER JOIN (mstrRentRoll)",
                                  "LOAD    %CustomerIDKey,",
                                  "\t\t%CommunityKey,",
                                  "\t\t%DateKey as MoveInDT,",
                                  "        Customer as ResidentName,",
                                  "\t\t1 as NewMoveInFlg,",
                                  "        0 as ActiveFlg",
                                  "FROM [lib://DataShare/QVD Transform/QVD_Transform_factReservation.qvd]",
                                  "(qvd) where Exists([%CommunityKey]) and %DateKey \u003e= Today() and %DateKey \u003c= (Today() + 14);"
                              ]
    },
    {
        "App":  "Care-Acuity",
        "Section":  "mstrCommunity",
        "LoadScriptContent":  [
                                  "///$tab mstrCommunity",
                                  "mstrCommunity:",
                                  "LOAD ",
                                  "    %CommunityKey,",
                                  "    CommunityID,",
                                  "    CommunityName,",
                                  "    Division,",
                                  "    Brand,",
                                  "    Portfolio,",
                                  "    Owner,",
                                  "    SVP,",
                                  "    Region,",
                                  "    RVP,",
                                  "    CommunityState,",
                                  "    CommunityCountry",
                                  "FROM [lib://DataShare/QVD Transform/QVD_Transform_mstrCommunity.qvd]",
                                  "(qvd);",
                                  "LEFT JOIN (mstrCommunity) ",
                                  "LOAD",
                                  "    Count(DISTINCT CustomerID) as NoOfResidents,",
                                  "    CommunityNumber as %CommunityKey",
                                  "FROM [lib://DataShare/QVD Extract/QVD_Extract_mstrCustomer.qvd] (qvd)",
                                  "WHERE Match(StatusID, 6, 7, 9, 11,8)",
                                  "GROUP BY CommunityNumber;",
                                  "",
                                  "",
                                  "",
                                  "map_community_id: MAPPING LOAD CommunityID, CommunityName Resident mstrCommunity;"
                              ]
    },
    {
        "App":  "Care-Acuity",
        "Section":  "mstrRentRoll",
        "LoadScriptContent":  [
                                  "///$tab mstrRentRoll",
                                  "mstrRentRoll:",
                                  "LOAD",
                                  "\tRowNo() as ID,",
                                  "    CMSResidentDashboard,",
                                  "    RMSLeaseManagement,",
                                  "    %CustomerIDKey,",
                                  "    %CommunityKey,",
                                  "    \"Resident\" as ResidentName,",
                                  "    RoomNumber,",
                                  "    PayorType,",
                                  "    CurrentRent,",
                                  "    RoomTypeStyleCode,",
                                  "    AssessedMedRate,",
                                  "    IsPhysicalPresentFlg,",
                                  "    AssessedCareType,",
                                  "    If(WildMatch(AssessedCareLevel, \u0027*Life*\u0027), null(), AssessedCareLevel) as AssessedCareLevel,",
                                  "    AssessedMedLevel,",
                                  "    Status,",
                                  "    Date(Floor(MoveInDt)) as MoveInDT,",
                                  "    Today() - MoveInDt as LengthOfStay,",
                                  "    Date(Floor(MoveInDt)) as %DateKey,",
                                  "    IF(MoveInDt \u003e= MonthStart(AddMonths(Today(), -1)), 1, 0) as NewMoveInFlg,",
                                  "    ScheduledMoveOutDT,",
                                  "    Gender,",
                                  "    1 as ActiveFlg,",
                                  "    BilledCareType,",
                                  "    BilledCareLevel",
                                  "FROM [lib://DataShare/QVD Transform/QVD_Transform_mstrRentRoll.qvd]",
                                  "(qvd) WHERE Exists([%CommunityKey]);",
                                  "",
                                  "LEFT JOIN (mstrRentRoll)",
                                  "LOAD",
                                  "    ID,",
                                  "        IF(DayNumberOfYear(DOB) \u003e DayNumberOfYear(Today()) and DayNumberOfYear(DOB) \u003c= DayNumberOfYear(Today() + 7), 1, 0) as UpcomingBirthdayFlg,",
                                  "    Age(Today(), DOB) as Age,",
                                  "    DOB",
                                  "FROM [lib://AttachedFiles/DOB REF.xlsx]",
                                  "(ooxml, embedded labels, table is Sheet1);",
                                  "",
                                  "",
                                  "LEFT JOIN (mstrRentRoll)",
                                  "LOAD Age, ",
                                  "\t if(Age \u003c 55, \u002754 and under\u0027,",
                                  "     \tif(Age \u003c= 66, \u002755 - 66\u0027,",
                                  "        \tif(Age \u003c= 74, \u002767 - 74\u0027,",
                                  "            \tif(Age \u003c= 85, \u002775 - 84\u0027,",
                                  "                \tif(Age \u003c= 94, \u002785 - 94\u0027,",
                                  "                    \t\u002795+\u0027))))) as AgeGroup",
                                  "Resident mstrRentRoll;"
                              ]
    },
    {
        "App":  "Care-Acuity",
        "Section":  "Section Access",
        "LoadScriptContent":  [
                                  "///$tab Section Access",
                                  "SecurityTEMP:",
                                  "LOAD",
                                  "    \"ACCESS\",",
                                  "    \"USERID\",",
                                  "    COMMUNITYNUMBER",
                                  "FROM [lib://DataShare/QVD Transform/QVD_Transform_SectionAccess.qvd]",
                                  "(qvd);",
                                  "",
                                  "Section Access;",
                                  "",
                                  "Security:",
                                  "NoConcatenate",
                                  "LOAD",
                                  "    \"ACCESS\",",
                                  "    \"USERID\",",
                                  "    COMMUNITYNUMBER",
                                  "Resident SecurityTEMP;",
                                  "",
                                  "Section Application;",
                                  "",
                                  "Drop Table SecurityTEMP;"
                              ]
    },
    {
        "App":  "Care-Acuity",
        "Section":  "tab_order.txt",
        "LoadScriptContent":  [
                                  "Main%tab_file_order_divider%Section Access%tab_file_order_divider%mstrCommunity%tab_file_order_divider%mstrRentRoll%tab_file_order_divider%fact_STL%tab_file_order_divider%Moves%tab_file_order_divider%Diagnosis%tab_file_order_divider%Mobility%tab_file_order_divider%dim_ date"
                              ]
    }
]
