[
    {
        "App":  "Atria-CommunityOperations-OpsCall",
        "Section":  "Communities",
        "LoadScriptContent":  [
                                  "$tab Communities",
                                  "[mstrCommunity]:",
                                  "LOAD",
                                  "*,",
                                  "IF(WildMatch(%CommunityKey, 10847) or WildMatch(Brand, \u0027Coterie\u0027), 1, 0) as ExcludeBonusFlg,",
                                  "IF(WildMatch(Division, \u0027HOL*\u0027), 1, 0) as ExcludeOtherMetricsFlg,",
                                  "IF(WildMatch(Division, \u0027HOL*\u0027) or Wildmatch(CommunityCountry,\u0027CAN\u0027), 1, 0) as HolidayBonusPictureFlg",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform\\QVD_Transform_mstrCommunity.qvd]",
                                  "(qvd);"
                              ]
    },
    {
        "App":  "Atria-CommunityOperations-OpsCall",
        "Section":  "dimDate",
        "LoadScriptContent":  [
                                  "$tab dimDate",
                                  "//\tload only the date field from our fact table. name it to a new field",
                                  "temp:",
                                  "load [%DateKey] as RangeDate\t//\tsource field should be the m/d/yyyy field from your fact table.",
                                  "resident  FactTable;",
                                  "",
                                  "//\tMinMaxDate finds the lowest and highest dates from the dates.",
                                  "//\tThis has been proven to work much faster than a typical group by on your transaction table.",
                                  "MinMaxDate:  ",
                                  "load min(RangeDate) as MinDate,  ",
                                  "\tmax(RangeDate) as MaxDate;  ",
                                  "load fieldvalue(\u0027RangeDate\u0027,iterno()) as RangeDate ",
                                  "autogenerate(1) while not isnull(fieldvalue(\u0027RangeDate\u0027,iterno()));  ",
                                  " ",
                                  "drop table temp;\t//\tno need to retain",
                                  "",
                                  "let varMinDate=date(peek(\u0027MinDate\u0027,0,\u0027MinMaxDate\u0027));",
                                  "let varMaxDate=date(peek(\u0027MaxDate\u0027,0,\u0027MinMaxDate\u0027));",
                                  "",
                                  "drop table MinMaxDate;\t//\tno need to retain",
                                  "",
                                  "dimDate:",
                                  "LOAD",
                                  "   MonthName\u0026\u0027 \u0027\u0026Year\u0026\u0027 #\u0027\u0026if(DayOfMonth \u003c 15, 1 ,  2) as ReviewPeriod, //from RNR app",
                                  "   IF(Match(DayOfWeekInMonth, 1, 3) and WildMatch(DayName, \u0027Thursday\u0027), 1, 0) as ReviewDateFlg, //from RNR app",
                                  "   ",
                                  "   IF(QuarterStart(Today()) = QuarterStart(%DateKey) and %DateKey \u003c= Today(), 1, 0) as CurrentQuarterSelect, //from RNR app",
                                  "    EffectiveDT,",
                                  "    %DateKey,",
                                  "    WeekStartMonday,",
                                  "    FullDateUSA,",
                                  "    DayOfMonth,",
                                  "    MonthDayCount,",
                                  "    DaySuffix,",
                                  "    \"DayName\",",
                                  "    DayOfWeekUSA,",
                                  "    DayOfWeekInMonth,",
                                  "    DayOfWeekInYear,",
                                  "    DayOfQuarter,",
                                  "    DayOfYear,",
                                  "    WeekOfMonth,",
                                  "    WeekOfQuarter,",
                                  "    WeekOfYear,",
                                  "    \"Month\",",
                                  "    \"MonthName\",",
                                  "    MonthOfQuarter,",
                                  "    Quarter,",
                                  "    \"QuarterName\",",
                                  "    IF(Quarter=1, \u0027Q1\u0027, IF(Quarter=2, \u0027Q2\u0027, IF(Quarter=3,\u0027Q3\u0027, IF(Quarter=4, \u0027Q4\u0027)))) AS QuarterPeriod,",
                                  "    \"Year\",",
                                  "    \"YearName\",",
                                  "    MonthYear,",
                                  "    MMYYYY,",
                                  "    FirstDayOfMonth,",
                                  "    LastDayOfMonth,",
                                  "    FirstDayOfQuarter,",
                                  "    LastDayOfQuarter,",
                                  "    FirstDayOfYear,",
                                  "    LastDayOfYear,",
                                  "    IsHolidayUSA,",
                                  "    IsWeekday,",
                                  "    HolidayUSA",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Extract\\QVD_Extract_dimDate.qvd]",
                                  "(qvd) where EffectiveDT \u003e=\u0027$(varMinDate)\u0027 and EffectiveDT \u003c=\u0027$(varMaxDate)\u0027;"
                              ]
    },
    {
        "App":  "Atria-CommunityOperations-OpsCall",
        "Section":  "FactTable",
        "LoadScriptContent":  [
                                  "$tab FactTable",
                                  "BPRAccounts:",
                                  "LOAD",
                                  "    AccountGroup,",
                                  "    Account as AccountInclude",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/.xls Library/Onestream/BPR Accounts.xlsx]",
                                  "(ooxml, embedded labels, table is Sheet1);",
                                  "",
                                  "",
                                  "",
                                  "",
                                  "FactTable:",
                                  "LOAD \u0027OneStream\u0027 as FactType,",
                                  "    %CommunityCode,",
                                  "    %CommunityKey,",
                                  "    CommunityDescription,",
                                  "    Scenario,",
                                  "    ScenarioDescription,",
                                  "    CurrencyIDMember,",
                                  "    Account,",
                                  "    AccountDescription,",
                                  "    Department,",
                                  "    DepartmentDescription,",
                                  "    UD2,",
                                  "    UD2Description,",
                                  "    %DateKey,",
                                  "    Amount,",
                                  "    AlternativeRevenueEntity",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform/QVD_Transform_OneStream.qvd]",
                                  "(qvd)",
                                  "Where \tWildMatch(Scenario, \u0027Actual\u0027, \u0027OP_Current\u0027) and ",
                                  "\t\tExists(AccountInclude, Account) AND",
                                  "        [%DateKey] \u003e= Date(YearStart(Today(),-1));",
                                  "        ",
                                  "Left Join (FactTable)",
                                  "LOAD",
                                  "    if(Wildmatch(AccountGroup, \u0027440210\u0027,\u0027400160\u0027,\u0027400180\u0027),\u0027MI Incentives\u0027, AccountGroup) as AccountGroup,",
                                  "    Account",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/.xls Library/Onestream/BPR Accounts.xlsx]",
                                  "(ooxml, embedded labels, table is Sheet1);",
                                  "",
                                  "Drop Table BPRAccounts;",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD \u0027Inquiries\u0027 as FactType,",
                                  "    %CommunityKey,",
                                  "    %CustomerIDKey,",
                                  "    %InquiryID,",
                                  "    LastStatusEffectiveDT,",
                                  "    Status,",
                                  "    ContactID,",
                                  "    \"Inquirer Dashboard\",",
                                  "    %DateKey,",
                                  "    DateOfInquiry,",
                                  "    ActiveCRMStatus,",
                                  "    StatusCategory,",
                                  "    InquiryStatusDate,",
                                  "    InquiryName",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform/QVD_Transform_factInquiryByReferral.qvd]",
                                  "(qvd)",
                                  "Where [%DateKey] \u003e= Date(YearStart(Today(),-1));",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD \u0027Occupancy\u0027 as FactType,",
                                  "%CommunityKey,",
                                  "%DateKey,",
                                  "M_UnitMoveIns",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform\\QVD_Transform_factUnitOccupancyByMonth.qvd]",
                                  "(qvd)",
                                  "Where [%DateKey] \u003e= Date(YearStart(Today(),-1));",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD IF(ISNULL(FactType), \u0027RNR\u0027, \u0027NoResidents\u0027) as FactType,",
                                  "    %CustomerIDKey,",
                                  "\tSTLDeparture,",
                                  "\tSTLActualReturn,",
                                  "\tSTLExpectedReturn,",
                                  "    EmployeeID,",
                                  "    ResidentReviewNeedID,",
                                  "    ResidentReviewID,",
                                  "    %DateKey,",
                                  "    DaysBetween,",
                                  "    ReviewCreateDT,",
                                  "    CustomerID,",
                                  "    NeedCreateDT,",
                                  "    NeedModifyDT,",
                                  "    Need,",
                                  "    ResidentStatus,",
                                  "    ResidentStatusID,",
                                  "    CareType,",
                                  "    CareTypeFinal,",
                                  "    BillingID,",
                                  "    ResidentName,",
                                  "    %CommunityKey,",
                                  "    ResidentReviewTaskID,",
                                  "    FollowUpStatusID,",
                                  "    FollowUpStatus,",
                                  "    FollowUpStatusDT,",
                                  "    FollowUpDueDT,",
                                  "    Outcome,",
                                  "    FollowUpCreateDT,",
                                  "    FollowUpModifyDT,",
                                  "    FollowUp,",
                                  "    JobTitle,",
                                  "    UserName,",
                                  "    NoCustomers,",
                                  "    NoCustomersPresent",
                                  "//     currentLocation",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform/QVD_Transform_RNR.qvd]",
                                  "(qvd)",
                                  ";",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD \u0027MoveIns\u0027 as FactType,",
                                  "*",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform/QVD_Transform_factRevenueByMoveIn.qvd]",
                                  "(qvd);",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD \u0027ProductInventory\u0027 as FactType,",
                                  "    ProductInventoryID,",
                                  "    %CommunityKey,",
                                  "    [%CommunityKey] as IncludeCommunity,",
                                  "    RoomNumber,",
                                  "    RoomType,",
                                  "    RoomTypeStyleCode,",
                                  "    CareType,",
                                  "//     GrossUnitArea,",
                                  "    IsOccupiedFlg,",
                                  "    IsReservedFlg,",
                                  "    If (IsReservedFlg=1,\u0027Reserved\u0027,\u0027Not Reserved\u0027) as ReservedStatus,",
                                  "   ",
                                  "//     IsVacancyScheduledFlg,",
                                  "//     IsSemiPrivateResidentFlg,",
                                  "    VacancyScheduledDT,",
                                  "    M_DaysVacant,",
                                  "    IsRoomReadyFlg,",
                                  "    If (IsRoomReadyFlg=1,\u0027Rent Ready\u0027,\u0027Not Rent Ready\u0027) as RentReadyStatus,",
                                  "    Grade,",
                                  "    StreetRate",
                                  "//     SpecialRate,",
                                  "//     IsOfflineFlg,",
                                  "//     OfflineDT,",
                                  "//     OfflineReason,",
                                  "//     OfflineNote,",
                                  "//     OnlineDT,",
                                  "//     OnlineDTEstimate,",
                                  "//     OnlineReason,",
                                  "//     RoomNote,",
                                  "//     SemiRate,",
                                  "//     RespiteRate,",
                                  "//     IsModelRoomFlg,",
                                  "//     Gender",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform/QVD_Transform_mstrProductInventory.qvd]",
                                  "(qvd)",
                                  "Where IsOfflineFlg = 0; //exclude offline and Newport Terrace",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD \u0027Hires\u0027 as FactType,",
                                  "    EMPLID,",
                                  "    Employee,",
                                  "    %CommunityKey,",
                                  "    DeptID,",
                                  "    JobCode,",
                                  "    JobTitle,",
                                  "    FullPartTime,",
                                  "    EmployeeExempt,",
                                  "    EmployeeType,",
                                  "    EmployeeClass,",
                                  "    %DateKey,",
                                  "    SegmentStartAction,",
                                  "    SegmentEndDT,",
                                  "    SegmentEndAction,",
                                  "    SegmentEndActionReason,",
                                  "    SegmentEndActionReasonDescription,",
                                  "    TerminationVoluntary,",
                                  "    IncludeHireFlg,",
                                  "    EmployeeSegment,",
                                  "    ServiceDT,",
                                  "    HireDT",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform\\QVD_Transform_factEmployeeSegmentHires.qvd]",
                                  "(qvd)",
                                  "Where IncludeHireFlg=1 and %DateKey\u003e=Date(Floor(MonthStart(Today(),-12))) and %DateKey\u003c=Date(Floor(weekend(Today())));",
                                  "",
                                  "// Concatenate(FactTable)",
                                  "// LOAD \u0027Terms\u0027 as FactType,",
                                  "//     EMPLID,",
                                  "//     Employee,",
                                  "//     %CommunityKey,",
                                  "//     DeptID,",
                                  "//     JobCode,",
                                  "//     JobTitle,",
                                  "//     FullPartTime,",
                                  "//     EmployeeExempt,",
                                  "//     EmployeeType,",
                                  "//     EmployeeClass,",
                                  "//     SegmentStartDT,",
                                  "//     SegmentStartAction,",
                                  "//     %DateKey,",
                                  "//     SegmentEndAction,",
                                  "//     SegmentEndActionReason,",
                                  "//     SegmentEndActionReasonDescription,",
                                  "//     TerminationVoluntary,",
                                  "//     IncludeTermFlg,",
                                  "//     EmployeeSegment,",
                                  "//     ServiceDT,",
                                  "//     HireDT,",
                                  "//     Tenure,",
                                  "//     TenureCategory",
                                  "// FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform\\QVD_Transform_factEmployeeSegment.qvd]",
                                  "// (qvd)",
                                  "// Where IncludeTermFlg=1 and %DateKey\u003e=Date(Floor(MonthStart(Today(),-12))) and %DateKey\u003c=Date(Floor(weekend(Today())));",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD",
                                  "    \u0027OpenPositions\u0027 as FactType,",
                                  "    %DateKey,",
                                  "    CommunityAndDeptName,",
                                  "    DDOpenFlg,",
                                  "    DeptID,",
                                  "    %CommunityKey,",
                                  "    JobTitle,",
                                  "    PositionID,",
                                  "    EmployeeClass,",
                                  "    EmployeeName,",
                                  "    \"Non-Volatile/Volatile\",",
                                  "    \"Stnd Hrs/Wk\",",
                                  "    OPWeekFlg,",
                                  "    OPMonthFlg,",
                                  "    OPTodayFlg",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform\\QVD_Transform_OpenPositions.qvd]",
                                  "(qvd)",
                                  "Where OPMonthFlg = 1;",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD",
                                  "\t\u0027QE\u0027 as FactType,",
                                  "    ReviewDashboard,",
                                  "    %ReviewIDKey,",
                                  "    %CommunityKey,",
                                  "    ReviewStatus,",
                                  "    %DateKey,",
                                  "    ReviewYear,",
                                  "    ReviewRound,",
                                  "    ReviewYearAndRound,",
                                  "    \"Net Score\",",
                                  "    MostEffectiveFlg",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform/QVD_Transform_factCommunityReview.qvd]",
                                  "(qvd)",
                                  "Where WildMatch(MostEffectiveFlg, \u0027Yes\u0027);",
                                  "",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD",
                                  "\t\u0027RateIncrease\u0027 as FactType,",
                                  "\t*",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform\\QVD_Transform_NewRateIncrease.qvd]",
                                  "(qvd)",
                                  "Where [%DateKey] \u003e= Date(Floor(MonthStart(Today(), 1))) and [%DateKey] \u003c Date(Floor(MonthStart(Today(), 2)));",
                                  "",
                                  "Concatenate(FactTable)",
                                  "LOAD \u0027Lifeline\u0027 as FactType,",
                                  "    \"Age\",",
                                  "    UniqueCode,",
                                  "    CommunityDeviceLocation,",
                                  "    T7,",
                                  "    DATAResDevWithoutName,",
                                  "    DATAMissingAlertCategory,",
                                  "    DATAPHBLogOnly,",
                                  "    DATAMissingDeviceInfo,",
                                  "    %CommunityKey,",
                                  "    %CustomerIDKey,",
                                  "    ResidentID,",
                                  "    DeviceID,",
                                  "    LowBatteryFlg,",
                                  "    isDeviceMissingFlg,",
                                  "    DeviceType,",
                                  "    AlertType,",
                                  "    DeviceGroup,",
                                  "    \"Resident Device\",",
                                  "    LogID,",
                                  "    SubCategory,",
                                  "    DeviceLocation,",
                                  "    ResponseRequired,",
                                  "    Display,",
                                  "    NoSupervisoryFlg,",
                                  "    SourceInstance,",
                                  "    %DateKey,",
                                  "    LogTime,",
                                  "    \"Hour\",",
                                  "    EventFlg,",
                                  "    AlertCategory,",
                                  "    DisplayType,",
                                  "    ResponseTime,",
                                  "    AttemptCount,",
                                  "    Response,",
                                  "    RequiredAndNoResponse,",
                                  "    ResidentNamePhilips,",
                                  "    ResidentLocationID,",
                                  "    ResidentLocation,",
                                  "    ResidentLocationClean,",
                                  "    MinLowBatDate,",
                                  "    MaxLowBatDate,",
                                  "    ARCResidentDashboard,",
                                  "    ARMLeaseManagement,",
                                  "    \"Resident\",",
                                  "    ResidentRMS,",
                                  "    RoomNumber,",
                                  "    PayorType,",
                                  "    AssessedCareType,",
                                  "    AssessedCareLevel,",
                                  "    AssessedMedLevel,",
                                  "    Status,",
                                  "    MoveInDt,",
                                  "    ScheduledMoveOutDT,",
                                  "    BilledCareType,",
                                  "    BilledCareLevel",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform/QVD_Transform_vwLifeline.qvd]",
                                  "(qvd)",
                                  "Where [Resident Device]=\u0027Resident Device\u0027 and ResponseRequired=\u0027Response Required\u0027 and EventFlg=\u0027Event\u0027 and Response=\u0027Responded\u0027 and T7 = \u0027Yes\u0027;"
                              ]
    },
    {
        "App":  "Atria-CommunityOperations-OpsCall",
        "Section":  "Main",
        "LoadScriptContent":  [
                                  "$tab Main",
                                  "SET ThousandSep=\u0027,\u0027;",
                                  "SET DecimalSep=\u0027.\u0027;",
                                  "SET MoneyThousandSep=\u0027,\u0027;",
                                  "SET MoneyDecimalSep=\u0027.\u0027;",
                                  "SET MoneyFormat=\u0027$#,##0.00;($#,##0.00)\u0027;",
                                  "SET TimeFormat=\u0027hh:mm:ss.mmm\u0027;",
                                  "SET DateFormat=\u0027M/D/YYYY\u0027;",
                                  "SET TimestampFormat=\u0027M/D/YYYY h:mm:ss[.fff] TT\u0027;",
                                  "SET FirstWeekDay=0;",
                                  "SET BrokenWeeks=1;",
                                  "SET ReferenceDay=0;",
                                  "SET DISABLE_INSIGHTS=1;",
                                  "SET FirstMonthOfYear=1;",
                                  "SET CollationLocale=\u0027en-US\u0027;",
                                  "SET CreateSearchIndexOnReload=0;",
                                  "SET MonthNames=\u0027Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec\u0027;",
                                  "SET LongMonthNames=\u0027January;February;March;April;May;June;July;August;September;October;November;December\u0027;",
                                  "SET DayNames=\u0027Mon;Tue;Wed;Thu;Fri;Sat;Sun\u0027;",
                                  "SET LongDayNames=\u0027Monday;Tuesday;Wednesday;Thursday;Friday;Saturday;Sunday\u0027;",
                                  "",
                                  "let vmindate=monthstart(Today(),-11);",
                                  "let vNOIStartARUS = IF(Year(MonthStart(Today(),-1)) = \u00272021\u0027, ",
                                  "\t\t\t\t\t\t\u00277/1/2021\u0027, ",
                                  "                        YearStart(MonthStart(Today(),-1)));",
                                  "let vRoomReady=\u0027Count\u0027;"
                              ]
    },
    {
        "App":  "Atria-CommunityOperations-OpsCall",
        "Section":  "Section Access",
        "LoadScriptContent":  [
                                  "$tab Section Access",
                                  "SecurityTEMP:",
                                  "LOAD",
                                  "\"ACCESS\",",
                                  "\"USERID\",",
                                  "COMMUNITYNUMBER",
                                  "FROM [lib://DataShare (atria_sanela.graziose)/QVD Transform/QVD_Transform_SectionAccess.qvd]",
                                  "(qvd);",
                                  "",
                                  "",
                                  "Section Access;",
                                  "",
                                  "",
                                  "Security:",
                                  "NoConcatenate",
                                  "LOAD",
                                  "\"ACCESS\",",
                                  "\"USERID\",",
                                  "COMMUNITYNUMBER",
                                  "Resident SecurityTEMP;",
                                  "",
                                  "",
                                  "Section Application;",
                                  "",
                                  "",
                                  "Drop Table SecurityTEMP;"
                              ]
    },
    {
        "App":  "Atria-CommunityOperations-OpsCall",
        "Section":  "tab_order.txt",
        "LoadScriptContent":  [
                                  "Section Access%tab_file_order_divider%Main%tab_file_order_divider%Communities%tab_file_order_divider%FactTable%tab_file_order_divider%dimDate"
                              ]
    }
]
